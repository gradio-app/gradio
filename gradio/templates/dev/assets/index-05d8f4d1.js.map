{"version":3,"file":"index-05d8f4d1.js","sources":["../../../../js/video/static/VideoPreview.svelte","../../../../js/video/static/StaticVideo.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { createEventDispatcher, afterUpdate, tick } from \"svelte\";\n\timport { BlockLabel, Empty, IconButton, ShareButton } from \"@gradio/atoms\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { Video, Download } from \"@gradio/icons\";\n\timport { uploadToHuggingFace } from \"@gradio/utils\";\n\n\timport { Player } from \"../shared\";\n\timport type { I18nFormatter } from \"js/app/src/gradio_helper\";\n\n\texport let value: FileData | null = null;\n\texport let subtitle: FileData | null = null;\n\texport let label: string | undefined = undefined;\n\texport let show_label = true;\n\texport let autoplay: boolean;\n\texport let show_share_button = true;\n\texport let i18n: I18nFormatter;\n\n\tlet old_value: FileData | null = null;\n\tlet old_subtitle: FileData | null = null;\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: FileData;\n\t\tplay: undefined;\n\t\tpause: undefined;\n\t\tend: undefined;\n\t\tstop: undefined;\n\t}>();\n\n\t$: value && dispatch(\"change\", value);\n\n\tafterUpdate(async () => {\n\t\t// needed to bust subtitle caching issues on Chrome\n\t\tif (\n\t\t\tvalue !== old_value &&\n\t\t\tsubtitle !== old_subtitle &&\n\t\t\told_subtitle !== null\n\t\t) {\n\t\t\told_value = value;\n\t\t\tvalue = null;\n\t\t\tawait tick();\n\t\t\tvalue = old_value;\n\t\t}\n\t\told_value = value;\n\t\told_subtitle = subtitle;\n\t});\n</script>\n\n<BlockLabel {show_label} Icon={Video} label={label || \"Video\"} />\n{#if value === null}\n\t<Empty unpadded_box={true} size=\"large\"><Video /></Empty>\n{:else}\n\t{#key value.data}\n\t\t<Player\n\t\t\tsrc={value.data}\n\t\t\tsubtitle={subtitle?.data}\n\t\t\t{autoplay}\n\t\t\ton:play\n\t\t\ton:pause\n\t\t\ton:stop\n\t\t\ton:end\n\t\t\tmirror={false}\n\t\t\t{label}\n\t\t/>\n\t{/key}\n\t<div class=\"icon-buttons\" data-testid=\"download-div\">\n\t\t<a\n\t\t\thref={value.data}\n\t\t\ttarget={window.__is_colab__ ? \"_blank\" : null}\n\t\t\tdownload={value.orig_name || value.name}\n\t\t>\n\t\t\t<IconButton Icon={Download} label=\"Download\" />\n\t\t</a>\n\t\t{#if show_share_button}\n\t\t\t<ShareButton\n\t\t\t\t{i18n}\n\t\t\t\ton:error\n\t\t\t\ton:share\n\t\t\t\t{value}\n\t\t\t\tformatter={async (value) => {\n\t\t\t\t\tif (!value) return \"\";\n\t\t\t\t\tlet url = await uploadToHuggingFace(value.data, \"url\");\n\t\t\t\t\treturn url;\n\t\t\t\t}}\n\t\t\t/>\n\t\t{/if}\n\t</div>\n{/if}\n\n<style>\n\t.icon-buttons {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: 6px;\n\t\tright: 6px;\n\t\tgap: var(--size-1);\n\t}\n</style>\n","<svelte:options accessors={true} />\n\n<script lang=\"ts\">\n\timport type { Gradio, ShareData } from \"@gradio/utils\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\timport { Block } from \"@gradio/atoms\";\n\timport StaticVideo from \"./VideoPreview.svelte\";\n\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport type { LoadingStatus } from \"@gradio/statustracker\";\n\n\texport let elem_id = \"\";\n\texport let elem_classes: string[] = [];\n\texport let visible = true;\n\texport let value: { video: FileData; subtitles: FileData | null } | null =\n\t\tnull;\n\tlet old_value: { video: FileData; subtitles: FileData | null } | null = null;\n\n\texport let label: string;\n\texport let source: \"upload\" | \"webcam\";\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let show_label: boolean;\n\texport let loading_status: LoadingStatus;\n\texport let height: number | undefined;\n\texport let width: number | undefined;\n\n\texport let container = false;\n\texport let scale: number | null = null;\n\texport let min_width: number | undefined = undefined;\n\texport let autoplay = false;\n\texport let show_share_button = true;\n\texport let gradio: Gradio<{\n\t\tchange: never;\n\t\tclear: never;\n\t\tplay: never;\n\t\tpause: never;\n\t\tupload: never;\n\t\tstop: never;\n\t\tend: never;\n\t\tstart_recording: never;\n\t\tstop_recording: never;\n\t\tshare: ShareData;\n\t\terror: string;\n\t}>;\n\n\tlet _video: FileData | null = null;\n\tlet _subtitle: FileData | null = null;\n\n\t$: {\n\t\tif (value != null) {\n\t\t\t_video = normalise_file(value.video, root, root_url);\n\t\t\t_subtitle = normalise_file(value.subtitles, root, root_url);\n\t\t} else {\n\t\t\t_video = null;\n\t\t\t_subtitle = null;\n\t\t}\n\t}\n\n\tlet dragging = false;\n\n\t$: {\n\t\tif (JSON.stringify(value) !== JSON.stringify(old_value)) {\n\t\t\told_value = value;\n\t\t\tgradio.dispatch(\"change\");\n\t\t}\n\t}\n</script>\n\n<Block\n\t{visible}\n\tvariant={value === null && source === \"upload\" ? \"dashed\" : \"solid\"}\n\tborder_mode={dragging ? \"focus\" : \"base\"}\n\tpadding={false}\n\t{elem_id}\n\t{elem_classes}\n\t{height}\n\t{width}\n\t{container}\n\t{scale}\n\t{min_width}\n\tallow_overflow={false}\n>\n\t<StatusTracker\n\t\tautoscroll={gradio.autoscroll}\n\t\ti18n={gradio.i18n}\n\t\t{...loading_status}\n\t/>\n\n\t<StaticVideo\n\t\tvalue={_video}\n\t\tsubtitle={_subtitle}\n\t\t{label}\n\t\t{show_label}\n\t\t{autoplay}\n\t\t{show_share_button}\n\t\ton:play={() => gradio.dispatch(\"play\")}\n\t\ton:pause={() => gradio.dispatch(\"pause\")}\n\t\ton:stop={() => gradio.dispatch(\"stop\")}\n\t\ton:end={() => gradio.dispatch(\"end\")}\n\t\ton:share={({ detail }) => gradio.dispatch(\"share\", detail)}\n\t\ton:error={({ detail }) => gradio.dispatch(\"error\", detail)}\n\t\ti18n={gradio.i18n}\n\t/>\n</Block>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAoDO,CAAA,IAAA,YAAA,aAAA,GAAK,IAAC,IAAI,CAAA;;;;;;;;;;;;kBAmBI,QAAQ,EAAA,KAAA,EAAA,UAAA,EAAA;;;;sCAEtB,GAAiB,CAAA,CAAA,CAAA,IAAA,iBAAA,CAAA,GAAA,CAAA,CAAA;;;;;;;;;;;AANf,GAAA,QAAA,CAAA,CAAA,EAAA,MAAA,EAAA,YAAA,aAAA,GAAK,IAAC,IAAI,CAAA,CAAA;AACR,GAAA,QAAA,CAAA,CAAA,EAAA,QAAA,EAAA,MAAM,CAAC,YAAY,GAAG,QAAQ,GAAG,IAAI,CAAA,CAAA;AACnC,GAAA,QAAA,CAAA,CAAA,EAAA,UAAA,EAAA,gBAAA,aAAA,GAAK,CAAC,CAAA,CAAA,CAAA,SAAS,cAAI,GAAK,IAAC,IAAI,CAAA,CAAA;;;;;;;;;GAJzC,UAqBK,CAAA,MAAA,EAAA,GAAA,EAAA,MAAA,CAAA,CAAA;GApBJ,UAMG,CAAA,GAAA,EAAA,CAAA,CAAA,CAAA;;;;;;;AApBE,GAAA,IAAA,KAAA,aAAA,CAAA,IAAA,cAAA,CAAA,YAAA,EAAA,YAAA,aAAA,GAAK,IAAC,IAAI,CAAA,EAAA;;;;;;;;;;;;AAeR,GAAA,IAAA,CAAA,OAAA,IAAA,KAAA,aAAA,CAAA,IAAA,YAAA,MAAA,YAAA,aAAA,GAAK,IAAC,IAAI,CAAA,EAAA;;;;AAEN,GAAA,IAAA,CAAA,OAAA,IAAA,KAAA,aAAA,CAAA,IAAA,gBAAA,MAAA,gBAAA,aAAA,GAAK,CAAC,CAAA,CAAA,CAAA,SAAS,cAAI,GAAK,IAAC,IAAI,CAAA,EAAA;;;;6BAInC,GAAiB,CAAA,CAAA,CAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAvBF,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIlB,IAAA,GAAA,YAAA,GAAK,IAAC,IAAI;AACL,IAAA,QAAA,eAAA,GAAQ,KAAE,IAAI;;YAMhB,KAAK;;;;;;;;;;;;;;;;;;;;;AAPR,GAAA,IAAA,KAAA,aAAA,CAAA,EAAA,cAAA,CAAA,GAAA,aAAA,GAAK,IAAC,IAAI,CAAA;AACL,GAAA,IAAA,KAAA,gBAAA,CAAA,EAAA,cAAA,CAAA,QAAA,gBAAA,GAAQ,KAAE,IAAI,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAPI,KAAK;AAAS,IAAA,KAAA,YAAA,GAAK,OAAI,OAAO;;;;;;;;;AACxD,EAAA,cAAA,GAAK,QAAK,IAAI,EAAA,OAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAD0B,GAAA,IAAA,KAAA,aAAA,CAAA,EAAA,kBAAA,CAAA,KAAA,aAAA,GAAK,OAAI,OAAO,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAtCjD,CAAA,IAAA,EAAA,KAAK,GAAoB,IAAI,EAAA,GAAA,OAAA,CAAA;AAC7B,CAAA,IAAA,EAAA,QAAQ,GAAoB,IAAI,EAAA,GAAA,OAAA,CAAA;AAChC,CAAA,IAAA,EAAA,KAAK,GAAuB,SAAS,EAAA,GAAA,OAAA,CAAA;AACrC,CAAA,IAAA,EAAA,UAAU,GAAG,IAAI,EAAA,GAAA,OAAA,CAAA;OACjB,QAAiB,EAAA,GAAA,OAAA,CAAA;AACjB,CAAA,IAAA,EAAA,iBAAiB,GAAG,IAAI,EAAA,GAAA,OAAA,CAAA;OACxB,IAAmB,EAAA,GAAA,OAAA,CAAA;AAE1B,CAAA,IAAA,SAAS,GAAoB,IAAI,CAAA;AACjC,CAAA,IAAA,YAAY,GAAoB,IAAI,CAAA;AAElC,CAAA,MAAA,QAAQ,GAAG,qBAAqB,EAAA,CAAA;;CAUtC,WAAW,CAAA,YAAA;;MAGT,KAAK,KAAK,SAAS,IACnB,QAAQ,KAAK,YAAY,IACzB,YAAY,KAAK,IAAI,EAAA;AAErB,GAAA,SAAS,GAAG,KAAK,CAAA;AACjB,GAAA,YAAA,CAAA,CAAA,EAAA,KAAK,GAAG,IAAI,CAAA,CAAA;SACN,IAAI,EAAA,CAAA;AACV,GAAA,YAAA,CAAA,CAAA,EAAA,KAAK,GAAG,SAAS,CAAA,CAAA;;;AAElB,EAAA,SAAS,GAAG,KAAK,CAAA;AACjB,EAAA,YAAY,GAAG,QAAQ,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAmCH,KAAK,IAAA;AACjB,EAAA,IAAA,CAAA,KAAK,SAAS,EAAE,CAAA;AACjB,EAAA,IAAA,GAAG,SAAS,mBAAmB,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAA,CAAA;SAC9C,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AArDd,GAAG,KAAK,IAAI,QAAQ,CAAC,QAAQ,EAAE,KAAK,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwDvB,GAAA,UAAA,aAAA,GAAM,KAAC,UAAU;;AACvB,EAAA,EAAA,IAAA,aAAA,GAAM,KAAC,IAAI,EAAA;qBACb,GAAc,CAAA,CAAA,CAAA;;;;;;;;;;;;;;;;sBAIX,GAAM,CAAA,EAAA,CAAA;4BACH,GAAS,CAAA,EAAA,CAAA;;;;;AAWb,IAAA,IAAA,aAAA,GAAM,KAAC,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAlBL,MAAA,UAAA,aAAA,GAAM,KAAC,UAAU;;AACvB,KAAA,KAAA,cAAA,KAAA,IAAA,EAAA,IAAA,aAAA,GAAM,KAAC,IAAI,EAAA;4EACb,GAAc,CAAA,CAAA,CAAA,CAAA;;;;;;wEAIX,GAAM,CAAA,EAAA,CAAA,CAAA;kFACH,GAAS,CAAA,EAAA,CAAA,CAAA;;;;;AAWb,GAAA,IAAA,KAAA,cAAA,KAAA,EAAA,mBAAA,CAAA,IAAA,cAAA,GAAM,KAAC,IAAI,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA/BT,IAAA,OAAA,YAAA,GAAK,CAAK,CAAA,CAAA,KAAA,IAAI,eAAI,GAAM,QAAK,QAAQ;MAAG,QAAQ;MAAG,OAAO;8BACtD,GAAQ,CAAA,EAAA,CAAA,GAAG,OAAO,GAAG,MAAM;aAC/B,KAAK;;;;;;;;oBAQE,KAAK;;;;;;;;;;;;;;;;;;;;;;AAVZ,GAAA,IAAA,KAAA,qBAAA,EAAA,EAAA,aAAA,CAAA,OAAA,aAAA,GAAK,CAAK,CAAA,CAAA,KAAA,IAAI,eAAI,GAAM,QAAK,QAAQ;KAAG,QAAQ;KAAG,OAAO,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA5DxD,CAAA,IAAA,EAAA,OAAO,GAAG,EAAE,EAAA,GAAA,OAAA,CAAA;OACZ,YAAY,GAAA,EAAA,EAAA,GAAA,OAAA,CAAA;AACZ,CAAA,IAAA,EAAA,OAAO,GAAG,IAAI,EAAA,GAAA,OAAA,CAAA;AACd,CAAA,IAAA,EAAA,KAAK,GACf,IAAI,EAAA,GAAA,OAAA,CAAA;AACD,CAAA,IAAA,SAAS,GAA2D,IAAI,CAAA;OAEjE,KAAa,EAAA,GAAA,OAAA,CAAA;OACb,MAA2B,EAAA,GAAA,OAAA,CAAA;OAC3B,IAAY,EAAA,GAAA,OAAA,CAAA;OACZ,QAAuB,EAAA,GAAA,OAAA,CAAA;OACvB,UAAmB,EAAA,GAAA,OAAA,CAAA;OACnB,cAA6B,EAAA,GAAA,OAAA,CAAA;OAC7B,MAA0B,EAAA,GAAA,OAAA,CAAA;OAC1B,KAAyB,EAAA,GAAA,OAAA,CAAA;AAEzB,CAAA,IAAA,EAAA,SAAS,GAAG,KAAK,EAAA,GAAA,OAAA,CAAA;AACjB,CAAA,IAAA,EAAA,KAAK,GAAkB,IAAI,EAAA,GAAA,OAAA,CAAA;AAC3B,CAAA,IAAA,EAAA,SAAS,GAAuB,SAAS,EAAA,GAAA,OAAA,CAAA;AACzC,CAAA,IAAA,EAAA,QAAQ,GAAG,KAAK,EAAA,GAAA,OAAA,CAAA;AAChB,CAAA,IAAA,EAAA,iBAAiB,GAAG,IAAI,EAAA,GAAA,OAAA,CAAA;OACxB,MAYT,EAAA,GAAA,OAAA,CAAA;AAEE,CAAA,IAAA,MAAM,GAAoB,IAAI,CAAA;AAC9B,CAAA,IAAA,SAAS,GAAoB,IAAI,CAAA;AAYjC,CAAA,IAAA,QAAQ,GAAG,KAAK,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAqCJ,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAA,CAAA;6BACrB,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAA,CAAA;4BACxB,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAA,CAAA;2BACvB,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAA,CAAA;AACtB,CAAA,MAAA,aAAA,GAAA,CAAA,EAAA,MAAM,OAAO,MAAM,CAAC,QAAQ,CAAC,OAAO,EAAE,MAAM,CAAA,CAAA;AAC5C,CAAA,MAAA,aAAA,GAAA,CAAA,EAAA,MAAM,OAAO,MAAM,CAAC,QAAQ,CAAC,OAAO,EAAE,MAAM,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GApDzD;AACI,IAAA,IAAA,KAAK,IAAI,IAAI,EAAA;sBAChB,MAAM,GAAG,cAAc,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,EAAE,QAAQ,CAAA,CAAA,CAAA;sBACnD,SAAS,GAAG,cAAc,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,EAAE,QAAQ,CAAA,CAAA,CAAA;;AAE1D,KAAA,YAAA,CAAA,EAAA,EAAA,MAAM,GAAG,IAAI,CAAA,CAAA;AACb,KAAA,YAAA,CAAA,EAAA,EAAA,SAAS,GAAG,IAAI,CAAA,CAAA;;;;;;GAMjB;QACI,IAAI,CAAC,SAAS,CAAC,KAAK,MAAM,IAAI,CAAC,SAAS,CAAC,SAAS,CAAA,EAAA;AACrD,KAAA,YAAA,CAAA,EAAA,EAAA,SAAS,GAAG,KAAK,CAAA,CAAA;KACjB,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}